<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Bellingham Co-Housing Community Analytics Portal - Financial transparency and utility tracking dashboards">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <title>BCCA Community Analytics</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <style>
        /* Password overlay */
        .password-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }
        .password-overlay.hidden { display: none; }
        .password-box {
            background: white;
            padding: 2.5rem;
            border-radius: 15px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
            text-align: center;
            max-width: 380px;
            width: 90%;
        }
        .password-box h2 {
            margin: 0 0 0.5rem 0;
            color: #2c3e50;
            font-size: 1.5rem;
            font-weight: 700;
        }
        .password-box p {
            margin: 0 0 1.5rem 0;
            color: #6b7280;
            font-size: 0.95rem;
        }
        .password-box input {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            margin-bottom: 1rem;
        }
        .password-box input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.15);
        }
        .password-box button {
            width: 100%;
            padding: 0.75rem 1rem;
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
        }
        .password-box button:hover { opacity: 0.9; }
        .password-box .error {
            color: #dc3545;
            font-size: 0.85rem;
            margin-top: 0.75rem;
            display: none;
        }
        .password-box .error.show { display: block; }

        body { background-color: #f0f2f5; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .hero { background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%); color: white; padding: 80px 0 60px; margin-bottom: 40px; }
        .card { border: none; border-radius: 15px; transition: transform 0.3s ease, box-shadow 0.3s ease; height: 100%; overflow: hidden; }
        .card:hover { transform: translateY(-10px); box-shadow: 0 15px 30px rgba(0,0,0,0.1); }
        .icon-circle { width: 80px; height: 80px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2.5rem; margin: 0 auto 20px; }
        .bg-soft-success { background-color: #d1e7dd; color: #198754; }
        .bg-soft-primary { background-color: #cfe2ff; color: #0d6efd; }
        .btn-custom { padding: 10px 25px; border-radius: 50px; font-weight: 600; letter-spacing: 0.5px; }
    </style>
</head>
<body>
    <!-- Password Protection Overlay -->
    <div id="password-overlay" class="password-overlay">
        <div class="password-box">
            <h2>Community Analytics Portal</h2>
            <p>Enter password to access BCCA financial data</p>
            <input type="password" id="password-input" placeholder="Password" autocomplete="off" />
            <button id="password-submit">Access Portal</button>
            <div id="password-error" class="error">Incorrect password. Please try again.</div>
        </div>
    </div>

    <div class="hero text-center">
        <div class="container">
            <h1 class="display-4 fw-bold mb-3">Community Analytics Portal</h1>
            <p class="lead opacity-75">Financial transparency and utility tracking for Bellingham Co-Housing</p>
        </div>
    </div>

    <div class="container pb-5">
        <div class="row g-5 justify-content-center">

            <div class="col-md-5">
                <div class="card shadow-sm p-4 text-center">
                    <div class="card-body">
                        <div class="icon-circle bg-soft-success">
                            <i class="bi bi-currency-dollar"></i>
                        </div>
                        <h2 class="h3 fw-bold mb-3">Budget Analysis</h2>
                        <p class="text-muted mb-4">Interactive dashboard comparing the 2025 Approved Budget vs. 2026 Proposed Budget, including variance waterfalls and department breakdowns.</p>
                        <a href="budget_analysis.html" class="btn btn-success btn-custom stretched-link">View Budget Data</a>
                    </div>
                </div>
            </div>

            <div class="col-md-5">
                <div class="card shadow-sm p-4 text-center">
                    <div class="card-body">
                        <div class="icon-circle bg-soft-primary">
                            <i class="bi bi-droplet-fill"></i>
                        </div>
                        <h2 class="h3 fw-bold mb-3">Water Bill Analysis</h2>
                        <p class="text-muted mb-4">Detailed breakdown of water and sewer costs, tracking consumption trends, seasonal anomalies, and cost reduction opportunities.</p>
                        <a href="water_analysis.html" class="btn btn-primary btn-custom stretched-link">View Water Data</a>
                    </div>
                </div>
            </div>

            <div class="col-md-5">
                <div class="card shadow-sm p-4 text-center">
                    <div class="card-body">
                        <div class="icon-circle" style="background-color: #e7f3ff; color: #0066cc;">
                            <i class="bi bi-graph-up-arrow"></i>
                        </div>
                        <h2 class="h3 fw-bold mb-3">Live Finance Dashboard</h2>
                        <p class="text-muted mb-4">Real-time QuickBooks data showing cash balances, budget vs actual spending by committee, and investment tracking.</p>
                        <a href="BCCAFinance.html" class="btn btn-custom stretched-link" style="background-color: #0066cc; color: white;">View Live Data</a>
                    </div>
                </div>
            </div>

            <div class="col-md-5">
                <div class="card shadow-sm p-4 text-center">
                    <div class="card-body">
                        <div class="icon-circle" style="background-color: #fff3e0; color: #f57c00;">
                            <i class="bi bi-receipt"></i>
                        </div>
                        <h2 class="h3 fw-bold mb-3">Transaction Details</h2>
                        <p class="text-muted mb-4">Browse and filter recent expense transactions by committee, vendor, or account. Detailed line-item expense tracking.</p>
                        <a href="transactions.html" class="btn btn-custom stretched-link" style="background-color: #f57c00; color: white;">View Transactions</a>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <footer class="text-center py-4 text-muted small">
        &copy; 2025 Bellingham Co-Housing Association
    </footer>

    <script>
        const PASSWORD_HASH = "c983c585ac3c40d920834f96200066352ff58e323da4dadae1d948fb27e63f82";
        const SESSION_KEY = "bcca_auth";

        async function hashPassword(password) {
            const encoder = new TextEncoder();
            const data = encoder.encode(password);
            const hashBuffer = await crypto.subtle.digest("SHA-256", data);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            return hashArray.map(b => b.toString(16).padStart(2, "0")).join("");
        }

        async function checkPassword() {
            const input = document.getElementById("password-input");
            const error = document.getElementById("password-error");
            const overlay = document.getElementById("password-overlay");

            const hash = await hashPassword(input.value);

            if (hash === PASSWORD_HASH) {
                sessionStorage.setItem(SESSION_KEY, "true");
                overlay.classList.add("hidden");
            } else {
                error.classList.add("show");
                input.value = "";
                input.focus();
            }
        }

        document.addEventListener("DOMContentLoaded", () => {
            const overlay = document.getElementById("password-overlay");

            // Check if already authenticated this session
            if (sessionStorage.getItem(SESSION_KEY) === "true") {
                overlay.classList.add("hidden");
                return;
            }

            // Set up event listeners
            document.getElementById("password-submit").addEventListener("click", checkPassword);
            document.getElementById("password-input").addEventListener("keypress", (e) => {
                if (e.key === "Enter") checkPassword();
            });
            document.getElementById("password-input").focus();
        });
    </script>
</body>
</html>